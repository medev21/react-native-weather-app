name: IOS Production Build

on: [push]

env:
    APP_NAME_STAGING: ${{ 'medev-weather-app/ENV_STAGING' }}
    APP_CENTER_TOKEN_STAGING: ${{ secrets.APP_CENTER_TOKEN_STAGING}}
    TESTING_GROUP_STAGING: ${{ 'ENV_STAGING' }}
    ARTIFACT_NAME: ${{ 'app_artifact' }}

jobs:
    deploy:
        name: Deploy
        runs-on: ubuntu-latest

        steps:

        - uses: actions/checkout@master
            
        - uses: actions/actions/download-artifact@v3
          with:
            name: ${{ env.ARTIFACT_NAME }}
            
        - name: set up JDK 1.8
          uses: actions/setup-java@v1
          with:
            java-version: 1.8

        - name: Upload to App Center STAGING
          uses: wzieba/AppCenter-Github-Action@v1
          with:
            appName: ${{ env.APP_NAME_STAGING }}
            token: ${{ env.APP_CENTER_TOKEN_STAGING }}
            group: ${{ env.TESTING_GROUP_STAGING }}
            file: ${{ runner.temp }}/build/WeatherApp.ipa
            notifyTesters: true
            debug: false
